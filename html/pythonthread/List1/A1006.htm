<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Pythonå®ç°çº¿ç¨‹æ±  - Python - language - ITeyeè®ºå›</title>
    <meta name="description" content="æœ€è¿‘åœ¨åšä¸€äº›æ–‡æœ¬å¤„ç†æ–¹é¢çš„äº‹æƒ…ï¼Œè€ƒè™‘åˆ°ç¨‹åºåˆ©ç”¨å¹¶å‘æ€§å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ï¼ˆä¸çº ç»“ç‰¹æ®Šåä¾‹ï¼‰ï¼Œäºæ˜¯å…¥å›´çš„Ideaå¦‚ä½¿ç”¨å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹è¾¾åˆ°æœŸæœ›çš„ç›®æ  ..." />
    <meta name="keywords" content="Python language" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    <link href="/rss/board/language" rel="alternate" title="ITeyeè®ºå›" type="application/rss+xml" />
    <link rel="search" type="application/opensearchdescription+xml" href="/open_search.xml" title="ITeye" />
    <link href="http://www.iteye.com/stylesheets/forum.css?1406686577" media="screen" rel="stylesheet" type="text/css" />
    <script src="http://www.iteye.com/javascripts/application.js?1358214518" type="text/javascript"></script>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-535605-1']);
  _gaq.push(['_setDomainName', 'iteye.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


      <link href="http://www.iteye.com/javascripts/syntaxhighlighter/SyntaxHighlighter.css?1348819953" media="screen" rel="stylesheet" type="text/css" />
  <script src="http://www.iteye.com/javascripts/syntaxhighlighter/shCoreCommon.js?1325907333" type="text/javascript"></script>
<script src="http://www.iteye.com/javascripts/hotkey.js?1324994303" type="text/javascript"></script>
  <script src="http://www.iteye.com/javascripts/code_favorites.js?1358214518" type="text/javascript"></script>
          <script src="http://www.iteye.com/javascripts/dragdrop.js?1324994303" type="text/javascript"></script>
          </head>
  <body>
    <div id="page">
      <div id="header">
        <div class="clearfix"><div id="user_nav">
      <a href="/login" class="welcome" title="ç™»å½•">æ‚¨è¿˜æœªç™»å½• !</a>
    <a href="/login">ç™»å½•</a>
    <a href="/signup" class="nobg">æ³¨å†Œ</a>
  </div>
</div>
        <div class="clearfix">
          <div id="branding">
            <a href="http://www.iteye.com"><img alt="ITeye-æœ€æ£’çš„è½¯ä»¶å¼€å‘äº¤æµç¤¾åŒº" src="http://www.iteye.com/images/logo.gif?1324994303" title="ITeye-æœ€æ£’çš„è½¯ä»¶å¼€å‘äº¤æµç¤¾åŒº" /></a>
          </div>
          <div id="gg"><IFRAME SRC="/iframe_ggbd/942" SCROLLING=no WIDTH=728 HEIGHT=90 FRAMEBORDER=0></IFRAME></div>
        </div>
      </div>

      <div id="content" class="clearfix">
        <div id="main">
          



          

<div class="h-entry" style='display:none'>
  <a href="http://cleverdeng.iteye.com" class="p-author" target="_blank">jeffreydan</a>
</div>


<div class="clearfix">
  <div class="crumbs">
    <a href="/forums">è®ºå›é¦–é¡µ</a> <span class="arrow">&rarr;</span>
    <a href="/forums/board/language">ç¼–ç¨‹è¯­è¨€æŠ€æœ¯è®ºå›</a> <span class="arrow">&rarr;</span>
    <h1>Pythonå®ç°çº¿ç¨‹æ± </h1>
  </div>
</div>


  <div id="forum_tag_list">
    <a href="/forums/board/language">å…¨éƒ¨</a>
          <a href='/forums/tag/Ruby'>Ruby</a>
          <a href='/forums/tag/Python'>Python</a>
          <a href='/forums/tag/PHP'>PHP</a>
          <a href='/forums/tag/Flash'>Flash</a>
          <a href='/forums/tag/C++'>C++</a>
          <a href='/forums/tag/.net'>.net</a>
              <a href="/forums/tag/Rails">Rails</a>
          <a href="/forums/tag/Flex">Flex</a>
          <a href="/forums/tag/C">C</a>
          <a href="/forums/tag/C%23">C#</a>
          <a href="/forums/tag/Windows">Windows</a>
      </div>


<div class="actions">
  <div class="buttons"></div>
  <div class="wrapper">
    <div id="forum_recommended_f4"><!--AdForward Begin:-->
<script type="text/javascript" ads-src="http://csdnim.allyes.com/main/s?user=iteye|forums|banner3&db=csdnim&border=0&local=yes&js=ie" src="http://creatim.allyes.com.cn/td/AllyesDeliver.min.js" charset="gbk"></script>
<!--AdForward End--></div>
    
    <div class="info">æµè§ˆ 5922 æ¬¡</div>
  </div>
</div>



<table id="forum_main" cellspacing="1">
  <thead>
    <tr>
      <th colspan="2" class="topic_title">
        <div class="wrapper"><span class='locked'>é”å®šè€å¸–å­</span> <a href="/topic/938193">ä¸»é¢˜ï¼šPythonå®ç°çº¿ç¨‹æ± </a></div>
        <div id='topic_rate_box'>ç²¾åå¸– (0) :: è‰¯å¥½å¸– (0) :: æ–°æ‰‹å¸– (0) :: éšè—å¸– (0)</div>
      </th>
    </tr>
    <tr>
      <td class="first_col">ä½œè€…</td>
      <td class="last_col">æ­£æ–‡
      
      </td>
    </tr>
  </thead>
  <tbody id="posts">
    <tr id="1942511">
  <td class="postauthor">
    <ul>
      <li class="name">jeffreydan</li>
      <li>ç­‰çº§: <img src="/images/star1.gif" alt="ä¸€æ˜Ÿä¼šå‘˜" title="ä¸€æ˜Ÿä¼šå‘˜"/></li>
      <li><a href='http://cleverdeng.iteye.com' target='_blank'><img alt="jeffreydançš„åšå®¢" class="logo" src="http://www.iteye.com/upload/logo/user/481217/7b6cc956-a906-396c-b016-82b70d50339c.jpg?1305346791" title="jeffreydançš„åšå®¢: CleverDengæ—¶å…‰ - è®°å½•ã€åˆ†äº«......" width="" /></a></li>
      <li>æ€§åˆ«: <img src="/images/icon_minigender_1.gif" title="ç”·"/></li>      <li>æ–‡ç« : 10</li>
      <li>ç§¯åˆ†: 100</li>
      <li>æ¥è‡ª: åŒ—äº¬</li>
      <li><img src='/images/status/offline.gif'/></li>
    </ul>
  </td>
  <td class="postcontent">
    <div class="postactions">
      <div class="description">
        &nbsp;&nbsp;
        å‘è¡¨æ—¶é—´ï¼š2011-03-02&nbsp;&nbsp;
        æœ€åä¿®æ”¹ï¼š2011-05-03
      </div>
      <div class="links">
        
        
          
          
        
      </div>
    </div>
    <div class="postbody clearfix">
      
        
              <script type="text/javascript">
      var hunters = ["\u003Ca href='/jobs/2509' target='_blank' style='color:#000;'\u003E\u003Cspan style='font-weight:bold;'\u003E\u4e0a\u6d77: \u003C/span\u003E Junior Product Manager\u003C/a\u003E","\u003Ca href='/jobs/1848' target='_blank' style='color:#000;'\u003E\u003Cspan style='font-weight:bold;'\u003E\u5317\u4eac: \u003C/span\u003E ITeye\u7f51\u7ad9\u8bda\u8058\u793e\u533a\u7f16\u8f91\u003C/a\u003E","\u003Ca href='/jobs/2507' target='_blank' style='color:#000;'\u003E\u003Cspan style='font-weight:bold;'\u003E\u5317\u4eac: \u003C/span\u003E \u3010\u5317\u4eac\u3011\u6570\u636e\u5206\u6790\u9ad8\u7ea7\u5de5\u7a0b\u5e08/\u7ecf\u7406\u003C/a\u003E","\u003Ca href='/jobs/2508' target='_blank' style='color:#000;'\u003E\u003Cspan style='font-weight:bold;'\u003E\u4e0a\u6d77: \u003C/span\u003E Senior Software Engineer\u003C/a\u003E","\u003Ca href='/jobs/2506' target='_blank' style='color:#000;'\u003E\u003Cspan style='font-weight:bold;'\u003E\u5317\u4eac: \u003C/span\u003E \u3010\u5317\u4eac\u3011\u6e38\u620f\u516c\u53f8\u8bda\u9080php\u5f00\u53d1\u5de5\u7a0b\u5e08\u003C/a\u003E"]
      var hunter_id = Math.ceil(Math.random() * hunters.length) - 1;
      if(hunter_id == -1) hunter_id = 0;
    </script>
    <div id="hunter_recommended" style="background:#fff;border: 1px solid #ccc; padding: 4px;margin-bottom: 10px;">
      <span id="hunters_nav" style="margin-right:5px;">
        <a href="#" onclick="hunter_id <= 0 ? hunter_id = hunters.length - 1 : hunter_id--; $('hunters').update(hunters[hunter_id]);return false;" style="border:1px solid #ccc;padding: 0 3px;size: 13px;text-decoration: none;">&lt;</a>
        <a href="#" onclick="hunter_id >= hunters.length - 1 ? hunter_id = 0 : hunter_id++; $('hunters').update(hunters[hunter_id]);return false;" style="border:1px solid #ccc;padding: 0 3px;size :13px;text-decoration: none;">&gt;</a>
      </span>
      çŒå¤´èŒä½: <span id="hunters"></span>
      <script type="text/javascript">$('hunters').update(hunters[hunter_id]);</script>
    </div>

        
      
                                            <div id="related_topics">ç›¸å…³æ–‡ç« : <span class="close"><a href="#" onclick="$('related_topics').hide();if($('hunter_recommended')){$('hunter_recommended').style.width='780px'};if($('topic_tags')){$('topic_tags').style.width='790px'};return false;" title="å…³é—­">&nbsp;</a></span>
              <ul>
                                  <li><a href='http://www.iteye.com/topic/1116020' title='å­¦å®Œçº¿ç¨‹,æ‘¸ç´¢ç€å†™äº†ä¸ªçº¿ç¨‹æ± ,æœ‰å¾…å®Œå–„' target='_blank'>å­¦å®Œçº¿ç¨‹,æ‘¸ç´¢ç€å†™äº†ä¸ªçº¿ç¨‹æ± ,æœ‰å¾…å®Œå–„</a></li>
                                  <li><a href='http://www.iteye.com/topic/1116585' title='MongoDB å†…å­˜è§£æ python' target='_blank'>MongoDB å†…å­˜è§£æ python</a></li>
                                  <li><a href='http://www.iteye.com/topic/369895' title='è®¾è®¡Pythonæ•°æ®åº“è¿æ¥æ± 1-å¯¹è±¡çš„å¾ªç¯å¼•ç”¨é—®é¢˜' target='_blank'>è®¾è®¡Pythonæ•°æ®åº“è¿æ¥æ± 1-å¯¹è±¡çš„å¾ªç¯å¼•ç”¨é—®é¢˜</a></li>
                              </ul>
              <br/><span>æ¨èç¾¤ç»„: <a href="http://hllvm.group.iteye.com" target="_blank">é«˜çº§è¯­è¨€è™šæ‹Ÿæœº</a></span>
              <br/><a href="/wiki/topic/938193" target="_blank">æ›´å¤šç›¸å…³æ¨è</a>
            </div>
            <script type="text/javascript">
              document.observe("dom:loaded", function() {
                if($('hunter_recommended')) {
                  $('hunter_recommended').setStyle({cssFloat: 'left', width: '557px'})
                }
                if($('topic_tags')) {
                  $('topic_tags').setStyle({width: '567px'})
                }
                new Draggable("related_topics");
              });
            </script>
                          
          <div id="topic_tags" class="news_tag">
                          <a href="/forums/tag/Python">Python</a>
                      </div>
        
      
      <p>æœ€è¿‘åœ¨åšä¸€äº›æ–‡æœ¬å¤„ç†æ–¹é¢çš„äº‹æƒ…ï¼Œè€ƒè™‘åˆ°ç¨‹åºåˆ©ç”¨å¹¶å‘æ€§å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ï¼ˆä¸çº ç»“ç‰¹æ®Šåä¾‹ï¼‰ï¼Œäºæ˜¯å…¥å›´çš„Ideaå¦‚ä½¿ç”¨å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹è¾¾åˆ°æœŸæœ›çš„ç›®æ ‡ï¼Œå¯¹äºè¿›ç¨‹æˆ–çº¿ç¨‹çš„åˆ›å»ºæ˜¯æœ‰ä»£ä»·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹æ± æ¥è¾¾åˆ°å·²åˆ›å»ºçš„çº¿ç¨‹åå¤ä½¿ç”¨ä»è€Œä½¿ä»£ä»·é™ä½åˆ°æœ€å°å‘¢ï¼Ÿ<br>
å½“ç„¶å¯ä»¥ï¼Œè¦æƒ³åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‚£ä¹ˆå¿…é¡»å¾—æœ‰ä¸ªå®¹å™¨æ¥æ¨¡æ‹Ÿâ€œæ± â€ï¼Œåœ¨Pythonä¸­ï¼Œé˜Ÿåˆ—è¿™æ ·çš„æ•°æ®ç»“æ„å°±å¯ä»¥å¸®æˆ‘ä»¬è§£å†³â€œæ± â€è¿™ä¸ªé—®é¢˜ï¼Œç„¶è€Œéšä¹‹å¼•æ¥çš„
å¤šçº¿ç¨‹ä¹‹é—´æ•°æ®å¤„ç†åŒæ­¥é—®é¢˜ï¼Œå¥½åœ¨Pythonä¸­æœ‰ä¸ªQueueæ¨¡å—å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸€æ£˜æ‰‹çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹æ± çš„é›å½¢äº†ã€‚</p>
<pre class="python" name="code"># !/usr/bin/env python
# -*- coding:utf-8 -*-

import Queue
import threading
import time

class WorkManager(object):
    def __init__(self, work_num=1000,thread_num=2):
        self.work_queue = Queue.Queue()
        self.threads = []
        self.__init_work_queue(work_num)
        self.__init_thread_pool(thread_num)

    """
        åˆå§‹åŒ–çº¿ç¨‹
    """
    def __init_thread_pool(self,thread_num):
        for i in range(thread_num):
            self.threads.append(Work(self.work_queue))

    """
        åˆå§‹åŒ–å·¥ä½œé˜Ÿåˆ—
    """
    def __init_work_queue(self, jobs_num):
        for i in range(jobs_num):
            self.add_job(do_job, i)

    """
        æ·»åŠ ä¸€é¡¹å·¥ä½œå…¥é˜Ÿ
    """
    def add_job(self, func, *args):
        self.work_queue.put((func, list(args)))#ä»»åŠ¡å…¥é˜Ÿï¼ŒQueueå†…éƒ¨å®ç°äº†åŒæ­¥æœºåˆ¶

    """
        ç­‰å¾…æ‰€æœ‰çº¿ç¨‹è¿è¡Œå®Œæ¯•
    """   
    def wait_allcomplete(self):
        for item in self.threads:
            if item.isAlive():item.join()

class Work(threading.Thread):
    def __init__(self, work_queue):
        threading.Thread.__init__(self)
        self.work_queue = work_queue
        self.start()

    def run(self):
        #æ­»å¾ªç¯ï¼Œä»è€Œè®©åˆ›å»ºçš„çº¿ç¨‹åœ¨ä¸€å®šæ¡ä»¶ä¸‹å…³é—­é€€å‡º
        while True:
            try:
                do, args = self.work_queue.get(block=False)#ä»»åŠ¡å¼‚æ­¥å‡ºé˜Ÿï¼ŒQueueå†…éƒ¨å®ç°äº†åŒæ­¥æœºåˆ¶
                do(args)
                self.work_queue.task_done()#é€šçŸ¥ç³»ç»Ÿä»»åŠ¡å®Œæˆ
            except:
                break

#å…·ä½“è¦åšçš„ä»»åŠ¡
def do_job(args):
    time.sleep(0.1)#æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
    print threading.current_thread(), list(args)

if __name__ == '__main__':
    start = time.time()
    work_manager =  WorkManager(10000, 10)#æˆ–è€…work_manager =  WorkManager(10000, 20)
    work_manager.wait_allcomplete()
    end = time.time()
    print "cost all time: %s" % (end-start)</pre>
<p>Â 2æ¬¡å¼€å¯ä¸åŒçš„çº¿ç¨‹æ•°è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre class="python" name="code">#work_manager =  WorkManager(10000, 10)
cost all time: 100.641790867(å•ä½ï¼šç§’)
#work_manager =  WorkManager(10000, 20)
cost all timeï¼š50.5233478546(å•ä½ï¼šç§’)</pre>
<p>Â ä¸Šé¢å®ç°äº†çº¿ç¨‹æ± çš„é›å½¢ï¼Œå±•ç°äº†åŸºæœ¬åŸç†ï¼Œå½“ç„¶è¦æƒ³æˆä¸ºé€šç”¨çš„APIéœ€è¦åšå¾ˆå¤šçš„å·¥ä½œï¼Œå¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿèµ·åˆ°æŠ›ç –å¼•ç‰çš„æ•ˆæœã€‚</p>
    </div>
    

          <div id="topic_copyright">å£°æ˜ï¼šITeyeæ–‡ç« ç‰ˆæƒå±äºä½œè€…ï¼Œå—æ³•å¾‹ä¿æŠ¤ã€‚æ²¡æœ‰ä½œè€…ä¹¦é¢è®¸å¯ä¸å¾—è½¬è½½ã€‚ </div>
      <div id="forum_recommended_f5"><span>æ¨èé“¾æ¥</span><ul><li><!--AdForward Begin:-->
<script type="text/javascript" ads-src="http://csdnim.allyes.com/main/s?user=iteye|forums|banner4&db=csdnim&border=0&local=yes&js=ie" src="http://creatim.allyes.com.cn/td/AllyesDeliver.min.js" charset="gbk"></script>
<!--AdForward End--></li></ul></div>
              <div id="forum_recommended_f0"><IFRAME SRC="/iframe_ggbd/155" SCROLLING=no WIDTH=728 HEIGHT=90 FRAMEBORDER=0></IFRAME></div>
        </td>
  </tr>
  <tr>
    <td class="postauthor"><a href="#">è¿”å›é¡¶æ¥¼</a></td>
    <td class="postcontent">
      <div class="icons">
        <a href='http://cleverdeng.iteye.com' class='icon_www' title='æµè§ˆä½œè€…çš„åšå®¢'>&nbsp;</a>
        <a href='http://cleverdeng.iteye.com/blog/profile' class='icon_profile' title='æµè§ˆä½œè€…èµ„æ–™'>&nbsp;</a>
        <a href="http://my.iteye.com/messages/new?message%5Breceiver_name%5D=jeffreydan" class="icon_pm" title="å‘é€ç«™å†…çŸ­ä¿¡">&nbsp;</a>
        <a href='http://cleverdeng.iteye.com/blog/guest_book' class='icon_guestbook' title='ç»™ä½œè€…ç•™è¨€'>&nbsp;</a>
        <a href="http://my.iteye.com/feed?subscription%5Bsubscribed_user_name%5D=jeffreydan" class="icon_rss" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '9njLfvjE7GBhGTKuGJP/jZocMaleu71iueuj/WmUtLI='); f.appendChild(s);f.submit();return false;" title="å…³æ³¨ä½œè€…">&nbsp</a>
              </div>
                    </td>
</tr>
<tr class="sep2"><td colspan="2"></td></tr>
<tr id="1964176">
  <td class="postauthor">
    <ul>
      <li class="name">passionke</li>
      <li>ç­‰çº§: åˆçº§ä¼šå‘˜</li>
      <li><a href='http://passionke.iteye.com' target='_blank'><img alt="passionkeçš„åšå®¢" class="logo" src="http://www.iteye.com/upload/logo/user/605464/a425ef95-fc8f-3130-b214-f9e321ae04b6.jpg?1323833544" title="passionkeçš„åšå®¢: " width="" /></a></li>
      <li>æ€§åˆ«: <img src="/images/icon_minigender_1.gif" title="ç”·"/></li>      <li>æ–‡ç« : 77</li>
      <li>ç§¯åˆ†: 0</li>
      <li>æ¥è‡ª: æ­å·</li>
      <li><img src='/images/status/offline.gif'/></li>
    </ul>
  </td>
  <td class="postcontent">
    <div class="postactions">
      <div class="description">
        &nbsp;&nbsp;
        å‘è¡¨æ—¶é—´ï¼š2011-03-10&nbsp;&nbsp;
        
      </div>
      <div class="links">
        
        
          
          
          
        
      </div>
    </div>
    <div class="postbody clearfix">
      
      
      è¿™ä¸ª&nbsp; å¤ªé•¿äº†å§ï½<br />å…¶å®æˆ‘è¿˜æ˜¯æ€€å¿µflexæ¡†æ¶ä¸‹çš„â€œå¤šçº¿ç¨‹â€å¼å†™æ³•<br /><br />å°±æ˜¯å¼€numäº‹ä»¶ï¼Œç„¶ååœ¨äº‹ä»¶ç»“æŸååˆ¤æ–­æ˜¯å¦æ»¡è¶³è¿è¡Œå®Œæ¯•çš„æ¡ä»¶<br />å¦‚æœæ˜¯å°±è·³å‡º å¦‚æœä¸æ˜¯ å†æ¥ä¸€è½®<br /><br />å¯æƒœåœ¨çº¿ç¨‹ä¸­ï¼Œä¼¼ä¹æ²¡æœ‰çº¿ç¨‹ææ„çš„è¯´æ³•<br />ä¹Ÿå°±æ˜¯å½“çº¿ç¨‹å®Œæ¯•çš„æ—¶å€™ æˆ‘ä»¬æ˜¯æ‹¿ä¸åˆ°ä¿¡å·çš„ ï¼ˆwhile è½®è¯¢ï¼Ÿ ä¸å¥½ï¼‰<br />çœ‹åˆ°è¿‡ä¸€ä¸ªç®€æ˜“ç‰ˆæœ¬çš„çº¿ç¨‹æ± &nbsp; å“ªä¸ªç®€å•å¹²å‡€ åˆ©äºç†è§£
    </div>
    

            </td>
  </tr>
  <tr>
    <td class="postauthor"><a href="#">è¿”å›é¡¶æ¥¼</a></td>
    <td class="postcontent">
      <div class="icons">
        <a href='http://passionke.iteye.com' class='icon_www' title='æµè§ˆä½œè€…çš„åšå®¢'>&nbsp;</a>
        <a href='http://passionke.iteye.com/blog/profile' class='icon_profile' title='æµè§ˆä½œè€…èµ„æ–™'>&nbsp;</a>
        <a href="http://my.iteye.com/messages/new?message%5Breceiver_name%5D=passionke" class="icon_pm" title="å‘é€ç«™å†…çŸ­ä¿¡">&nbsp;</a>
        <a href='http://passionke.iteye.com/blog/guest_book' class='icon_guestbook' title='ç»™ä½œè€…ç•™è¨€'>&nbsp;</a>
        <a href="http://my.iteye.com/feed?subscription%5Bsubscribed_user_name%5D=passionke" class="icon_rss" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '9njLfvjE7GBhGTKuGJP/jZocMaleu71iueuj/WmUtLI='); f.appendChild(s);f.submit();return false;" title="å…³æ³¨ä½œè€…">&nbsp</a>
                  <a href="#1964176" title="passionkeå›å¸–:Pythonå®ç°çº¿ç¨‹æ± ">å›å¸–åœ°å€</a>
              </div>
                        <div id='post_rate_box_1964176' class='post_rate_box'><a href='#' onclick='return false;' class='good' title='å¥½'>0</a> <a href='#' onclick='return false;' class='hidden' title='å·®'>0</a> è¯·ç™»å½•åæŠ•ç¥¨</div>              </td>
</tr>
<tr class="sep2"><td colspan="2"></td></tr>
<tr id="1964831">
  <td class="postauthor">
    <ul>
      <li class="name">simomo</li>
      <li>ç­‰çº§: åˆçº§ä¼šå‘˜</li>
      <li><a href='http://simomo.iteye.com' target='_blank'><img alt="simomoçš„åšå®¢" class="logo" src="http://www.iteye.com/images/user-logo.gif?1324994303" title="simomoçš„åšå®¢: å†·çœ¼" width="" /></a></li>
      <li>æ€§åˆ«: <img src="/images/icon_minigender_1.gif" title="ç”·"/></li>      <li>æ–‡ç« : 11</li>
      <li>ç§¯åˆ†: 50</li>
      <li>æ¥è‡ª: éƒ‘å·</li>
      <li><img src='/images/status/offline.gif'/></li>
    </ul>
  </td>
  <td class="postcontent">
    <div class="postactions">
      <div class="description">
        &nbsp;&nbsp;
        å‘è¡¨æ—¶é—´ï¼š2011-03-11&nbsp;&nbsp;
        
      </div>
      <div class="links">
        
        
          
          
          
        
      </div>
    </div>
    <div class="postbody clearfix">
      
      
      <p>Â æœ€è¿‘åšä¸€ä¸ªé¡¹ç›®ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ‰€ä»¥æ‰¾äº†ä¸€ä¸ªè€å¤–çš„å¼€æºé¡¹ç›®ä¸­ç”¨çš„çº¿ç¨‹æ± ä»£ç ï¼Œæ€»å…±æœ‰ taskï¼Œ workthreadï¼Œ threadpoolä¸‰å¤§éƒ¨åˆ†ã€‚ä¸å¤ªæ¸…æ¥šçš„æ˜¯ä½ è¯´çš„queueæ˜¯ä»€ä¹ˆlibï¼Ÿ<br></p>
<pre class="python" name="code">import threading

class WorkerTask(object):
    """A task to be performed by the ThreadPool."""

    def __init__(self, function, args=(), kwargs={}):
        self.function = function
        self.args = args
        self.kwargs = kwargs

    def __call__(self):
        self.function(*self.args, **self.kwargs)


class WorkerThread(threading.Thread):
    """A thread managed by a thread pool."""

    def __init__(self, pool):
        threading.Thread.__init__(self)
        self.setDaemon(True)
        self.pool = pool
        self.busy = False
        self._started = False
        self._event = None

    def work(self):
        if self._started is True:
            if self._event is not None and not self._event.isSet():
                self._event.set()
        else:
            self._started = True
            self.start()

    def run(self):
        while True:
            self.busy = True
            while len(self.pool._tasks) &gt; 0:
                try:
                    task = self.pool._tasks.pop()
                    task()
                except IndexError:
                    # Just in case another thread grabbed the task 1st.
                    pass

            # Sleep until needed again
            self.busy = False
            if self._event is None:
                self._event = threading.Event()
            else:
                self._event.clear()
            self._event.wait()

class ThreadPool(object):
    """Executes queued tasks in the background."""

    def __init__(self, max_pool_size=10):
        self.max_pool_size = max_pool_size
        self._threads = []
        self._tasks = [] 

    def _addTask(self, task):
        self._tasks.append(task)

        worker_thread = None
        for thread in self._threads:
            if thread.busy is False:
                worker_thread = thread
                break

        if worker_thread is None and len(self._threads) &lt;= self.max_pool_size:
            worker_thread = WorkerThread(self)
            self._threads.append(worker_thread)

        if worker_thread is not None:
            worker_thread.work()

    def addTask(self, function, args=(), kwargs={}):
        self._addTask(WorkerTask(function, args, kwargs))

class GlobalThreadPool(object):
    """ThreadPool Singleton class."""

    _instance = None

    def __init__(self):
        """Create singleton instance """

        if GlobalThreadPool._instance is None:
            # Create and remember instance
            GlobalThreadPool._instance = ThreadPool()

    def __getattr__(self, attr):
        """ Delegate get access to implementation """
        return getattr(self._instance, attr)

    def __setattr__(self, attr, val):
        """ Delegate set access to implementation """
        return setattr(self._instance, attr, val)
</pre>
Â 
<p>Â </p>
    </div>
    

            </td>
  </tr>
  <tr>
    <td class="postauthor"><a href="#">è¿”å›é¡¶æ¥¼</a></td>
    <td class="postcontent">
      <div class="icons">
        <a href='http://simomo.iteye.com' class='icon_www' title='æµè§ˆä½œè€…çš„åšå®¢'>&nbsp;</a>
        <a href='http://simomo.iteye.com/blog/profile' class='icon_profile' title='æµè§ˆä½œè€…èµ„æ–™'>&nbsp;</a>
        <a href="http://my.iteye.com/messages/new?message%5Breceiver_name%5D=simomo" class="icon_pm" title="å‘é€ç«™å†…çŸ­ä¿¡">&nbsp;</a>
        <a href='http://simomo.iteye.com/blog/guest_book' class='icon_guestbook' title='ç»™ä½œè€…ç•™è¨€'>&nbsp;</a>
        <a href="http://my.iteye.com/feed?subscription%5Bsubscribed_user_name%5D=simomo" class="icon_rss" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '9njLfvjE7GBhGTKuGJP/jZocMaleu71iueuj/WmUtLI='); f.appendChild(s);f.submit();return false;" title="å…³æ³¨ä½œè€…">&nbsp</a>
                  <a href="#1964831" title="simomoå›å¸–:Pythonå®ç°çº¿ç¨‹æ± ">å›å¸–åœ°å€</a>
              </div>
                        <div id='post_rate_box_1964831' class='post_rate_box'><a href='#' onclick='return false;' class='good' title='å¥½'>0</a> <a href='#' onclick='return false;' class='hidden' title='å·®'>0</a> è¯·ç™»å½•åæŠ•ç¥¨</div>              </td>
</tr>
<tr class="sep2"><td colspan="2"></td></tr>
<tr id="1965854">
  <td class="postauthor">
    <ul>
      <li class="name">mathgl</li>
      <li>ç­‰çº§: åˆçº§ä¼šå‘˜</li>
      <li><a href='http://mathgl.iteye.com' target='_blank'><img alt="mathglçš„åšå®¢" class="logo" src="http://www.iteye.com/images/user-logo.gif?1324994303" title="mathglçš„åšå®¢: mathgl" width="" /></a></li>
      <li>æ€§åˆ«: <img src="/images/icon_minigender_1.gif" title="ç”·"/></li>      <li>æ–‡ç« : 1101</li>
      <li>ç§¯åˆ†: 50</li>
      <li>æ¥è‡ª: HK</li>
      <li><img src='/images/status/offline.gif'/></li>
    </ul>
  </td>
  <td class="postcontent">
    <div class="postactions">
      <div class="description">
        &nbsp;&nbsp;
        å‘è¡¨æ—¶é—´ï¼š2011-03-11&nbsp;&nbsp;
        
      </div>
      <div class="links">
        
        
          
          
          
        
      </div>
    </div>
    <div class="postbody clearfix">
      
      
      <div class="quote_title">simomo å†™é“</div>
<div class="quote_div">
<p>Â æœ€è¿‘åšä¸€ä¸ªé¡¹ç›®ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ‰€ä»¥æ‰¾äº†ä¸€ä¸ªè€å¤–çš„å¼€æºé¡¹ç›®ä¸­ç”¨çš„çº¿ç¨‹æ± ä»£ç ï¼Œæ€»å…±æœ‰ taskï¼Œ workthreadï¼Œ threadpoolä¸‰å¤§éƒ¨åˆ†ã€‚ä¸å¤ªæ¸…æ¥šçš„æ˜¯ä½ è¯´çš„queueæ˜¯ä»€ä¹ˆlibï¼Ÿ</p>
<pre class="python" name="code">
</pre>
Â 
<p>Â </p>
</div>
<p>åº”è¯¥æ˜¯2.5ä¹‹åæ–°å¢çš„ æ ‡å‡†åº“çš„é‚£ä¸ªQueue...2.6å multipleprocessingé‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªã€‚ä¸è¿‡é‚£ä¸ªæ˜¯ç»™å¤šè¿›ç¨‹ç”¨çš„ã€‚ã€‚ã€‚</p>
    </div>
    

            </td>
  </tr>
  <tr>
    <td class="postauthor"><a href="#">è¿”å›é¡¶æ¥¼</a></td>
    <td class="postcontent">
      <div class="icons">
        <a href='http://mathgl.iteye.com' class='icon_www' title='æµè§ˆä½œè€…çš„åšå®¢'>&nbsp;</a>
        <a href='http://mathgl.iteye.com/blog/profile' class='icon_profile' title='æµè§ˆä½œè€…èµ„æ–™'>&nbsp;</a>
        <a href="http://my.iteye.com/messages/new?message%5Breceiver_name%5D=mathgl" class="icon_pm" title="å‘é€ç«™å†…çŸ­ä¿¡">&nbsp;</a>
        <a href='http://mathgl.iteye.com/blog/guest_book' class='icon_guestbook' title='ç»™ä½œè€…ç•™è¨€'>&nbsp;</a>
        <a href="http://my.iteye.com/feed?subscription%5Bsubscribed_user_name%5D=mathgl" class="icon_rss" onclick="var f = document.createElement('form'); f.style.display = 'none'; this.parentNode.appendChild(f); f.method = 'POST'; f.action = this.href;var s = document.createElement('input'); s.setAttribute('type', 'hidden'); s.setAttribute('name', 'authenticity_token'); s.setAttribute('value', '9njLfvjE7GBhGTKuGJP/jZocMaleu71iueuj/WmUtLI='); f.appendChild(s);f.submit();return false;" title="å…³æ³¨ä½œè€…">&nbsp</a>
                  <a href="#1965854" title="mathglå›å¸–:Pythonå®ç°çº¿ç¨‹æ± ">å›å¸–åœ°å€</a>
              </div>
                        <div id='post_rate_box_1965854' class='post_rate_box'><a href='#' onclick='return false;' class='good' title='å¥½'>0</a> <a href='#' onclick='return false;' class='hidden' title='å·®'>0</a> è¯·ç™»å½•åæŠ•ç¥¨</div>              </td>
</tr>
<tr class="sep2"><td colspan="2"></td></tr>

  </tbody>
</table>


<div class="actions">
  <div class="buttons"></div>
  <div class="wrapper"></div>
</div>

<div>
  <div class="crumbs">
    <a href="/forums">è®ºå›é¦–é¡µ</a> <span class="arrow">&rarr;</span>
    <a href="/forums/board/language">ç¼–ç¨‹è¯­è¨€æŠ€æœ¯ç‰ˆ</a>
    <br/><br/>è·³è½¬è®ºå›:<select id="forum_urlname" name="forum[urlname]" onchange="window.location='/forums/board/'+this.value"><option value="mobile">ç§»åŠ¨å¼€å‘æŠ€æœ¯</option>
<option value="web">Webå‰ç«¯æŠ€æœ¯</option>
<option value="Java">Javaä¼ä¸šåº”ç”¨</option>
<option value="language" selected="selected">ç¼–ç¨‹è¯­è¨€æŠ€æœ¯</option>
<option value="Tech">ç»¼åˆæŠ€æœ¯</option>
<option value="New">å…¥é—¨æŠ€æœ¯</option>
<option value="Job">æ‹›è˜æ±‚èŒ</option>
<option value="Life">æµ·é˜”å¤©ç©º</option></select>
    
  </div>

  
</div>

<div style="display:none">
  <form action="/posts/rate" id="post_rate_form" method="post" onsubmit="new Ajax.Request('/posts/rate', {asynchronous:true, evalScripts:true, parameters:Form.serialize(this)}); return false;"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="9njLfvjE7GBhGTKuGJP/jZocMaleu71iueuj/WmUtLI=" /></div>
    <input type="hidden" id="post_rate_id" name="id"/>
    <input type="hidden" id="post_rate_type" name="type"/>
  </form></div>

<script type="text/javascript">
  function processComment() {
    fix_image_size($$('div.postbody img'), 760);
    
    $$('#forum_main > #posts > tr[id]').each(function(tr){
      var post_id = tr.id;
      $$("#"+post_id+" pre[name=code]").each(function(pre, index){
        var location = window.location;
        source_url = location.protocol + "//" + location.host + location.pathname + location.search;
        source_url += "#" + post_id;
        pre.writeAttribute('codeable_type', 'Post');
        pre.writeAttribute('codeable_id', post_id);
        pre.writeAttribute('source_url', source_url);
        pre.writeAttribute('pre_index', index);
        pre.writeAttribute('title', 'Pythonå®ç°çº¿ç¨‹æ± ');
      });
    });
  }

  dp.SyntaxHighlighter.HighlightAll('code', true, true);
  processComment();
  code_favorites_init();

  function rate_post(id, type) {
    Element.update('post_rate_box_' + id, 'æäº¤ä¸­...');
    new Ajax.Request('/posts/rate', {asynchronous:true, evalScripts:true, parameters:{"id":id, "type":type}});
  }

  function rate_topic(type) {
    Element.update('topic_rate_box', 'æäº¤ä¸­...');
    new Ajax.Request('/topics/rate', {asynchronous:true, evalScripts:true, parameters:{"id":938193, "type":type}});
  }
</script>



        </div>
        <div id="nav">
  <div class="wrapper">
    <ul>
            <li><a href="http://www.iteye.com/">é¦–é¡µ</a></li>
      <li><a href="http://www.iteye.com/news">èµ„è®¯</a></li>
      <li><a href="http://www.iteye.com/magazines">ç²¾å</a></li>
      <li><a href="http://www.iteye.com/forums" class='selected'>è®ºå›</a></li>
      <li><a href="http://www.iteye.com/ask">é—®ç­”</a></li>
      <li><a href="http://www.iteye.com/blogs">åšå®¢</a></li>
      <li><a href="http://www.iteye.com/blogs/subjects">ä¸“æ </a></li>
      <li><a href="http://www.iteye.com/groups">ç¾¤ç»„</a></li>
      <li><a target="_blank" href="http://job.iteye.com/iteye">æ‹›è˜</a></li>
      <li class="last"><a href="http://www.iteye.com/search">æœç´¢</a></li>
    </ul>
  </div>
</div>
      </div>
      <div id="footer">
  <div id="site_nav">
    <ul>
      <li><a href="/index/service">å¹¿å‘ŠæœåŠ¡</a></li>
      <li><a href="http://webmaster.iteye.com">ITeyeé»‘æ¿æŠ¥</a></li>
      <li><a href="/index/contactus">è”ç³»æˆ‘ä»¬</a></li>
      <li class="last"><a href="/index/friend_links">å‹æƒ…é“¾æ¥</a></li>
    </ul>
  </div>
  <div id="copyright">
    &copy; 2003-2014 ITeye.com.    [ <a href="http://www.miibeian.gov.cn">äº¬ICPè¯110151å·</a>  äº¬å…¬ç½‘å®‰å¤‡110105010620 ]<br/>
    ç™¾è”ä¼˜åŠ›(åŒ—äº¬)æŠ•èµ„æœ‰é™å…¬å¸  ç‰ˆæƒæ‰€æœ‰<br />
  </div>
</div>

    </div>
    <script type="text/javascript">
  document.write("<img src='http://stat.iteye.com/?url="+ encodeURIComponent(document.location.href) + "&referrer=" + encodeURIComponent(document.referrer) + "&user_id=' width='0' height='0' />");
</script>

<script src="http://csdnimg.cn/pubfooter/js/tracking.js?version=20130923164150" type="text/javascript"></script>

  </body>
</html>
